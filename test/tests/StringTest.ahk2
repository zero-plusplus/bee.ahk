#Include ..\common.ahk2

class StringTest {
  class StaticTest {
    testRepeat(assert) {
      assert.equals(bee.String.repeat("abc", 3), "abcabcabc")
    }
    testSlice(assert) {
      assert.equals(bee.String.slice("12345", 1, 5), "1234")
      assert.equals(bee.String.slice("12345", "1..5"), "1234")

      assert.equals(bee.String.slice("12345", "^2..^1"), "4")
      assert.equals(bee.String.slice("12345", "1..^1"), "1234")
    }
    testLength(assert) {
      assert.equals(bee.String.length("abc"), 3)
    }
  }
  class InstanceTest {
    testRepeat(assert) {
      assert.equals(bee.String("abc").repeat(3), "abcabcabc")
    }
    testValue(assert) {
      assert.equals(bee.String("abc").value, "abc")
    }
    testLength(assert) {
      assert.equals(bee.String("abc").length, 3)
    }
    testSlice(assert) {
      assert.equals(bee.String("12345").slice(1, 5).value, "1234")
      assert.equals(bee.String("12345").slice("1..5").value, "1234")

      assert.equals(bee.String("12345").slice("^2..^1").value, "4")
      assert.equals(bee.String("12345").slice("1..^1").value, "1234")
    }
  }
}